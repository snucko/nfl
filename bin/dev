#!/bin/bash
set -euo pipefail

# TRMNL Development Server Runner
# This script runs the official TRMNL development environment using Docker

cd "$(dirname "$0")/.."

echo "🏈 Starting NFL TRMNL Plugin Development Server..."
echo ""
echo "📊 Updating NFL data..."
python3 nfl_build.py

echo ""
echo "🚀 Starting TRMNL Preview Server..."
echo "   • Full size: http://localhost:4567/full"
echo "   • Half horizontal: http://localhost:4567/half_horizontal" 
echo "   • Half vertical: http://localhost:4567/half_vertical"
echo "   • Quadrant: http://localhost:4567/quadrant"
echo ""
echo "📱 The server will auto-reload when you change files in src/"
echo "⏹️  Press Ctrl+C to stop"
echo ""

# Run the TRMNL preview server with Docker
docker run \
    --rm \
    --interactive \
    --tty \
    --publish 4567:4567 \
    --volume "$(pwd):/plugin" \
    trmnl/trmnlp serve