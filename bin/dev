#!/bin/bash
set -euo pipefail

# TRMNL Development Server Runner
# This script runs the official TRMNL development environment using Docker

cd "$(dirname "$0")/.."

echo "ğŸˆ Starting NFL TRMNL Plugin Development Server..."
echo ""
echo "ğŸ“Š Updating NFL data..."
python3 nfl_build.py

echo ""
echo "ğŸš€ Starting TRMNL Preview Server..."
echo "   â€¢ Full size: http://localhost:4567/full"
echo "   â€¢ Half horizontal: http://localhost:4567/half_horizontal" 
echo "   â€¢ Half vertical: http://localhost:4567/half_vertical"
echo "   â€¢ Quadrant: http://localhost:4567/quadrant"
echo ""
echo "ğŸ“± The server will auto-reload when you change files in src/"
echo "â¹ï¸  Press Ctrl+C to stop"
echo ""

# Run the TRMNL preview server with Docker
docker run \
    --rm \
    --interactive \
    --tty \
    --publish 4567:4567 \
    --volume "$(pwd):/plugin" \
    trmnl/trmnlp serve