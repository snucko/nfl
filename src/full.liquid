{% comment %}
NFL Schedule - Full Size TRMNL Plugin
Fetches live data from GitHub Pages
{% endcomment %}

{% assign api_url = "https://snucko.github.io/nfl/schedule.json" %}
{% assign nfl_data = api_url | fetch_json %}

<div class="plugin">
  <h1 class="title">
    {% if nfl_data.season and nfl_data.week %}
      NFL Week {{ nfl_data.week.number }} · {{ nfl_data.season.year }}
      {% if nfl_data.season.type == 2 %}(Regular Season){% elsif nfl_data.season.type == 3 %}(Playoffs){% endif %}
    {% else %}
      NFL Schedule
    {% endif %}
  </h1>
  
  <div class="games">
    {% if nfl_data.events %}
      {% for event in nfl_data.events %}
        {% assign competition = event.competitions.first %}
        {% assign status = competition.status %}
        {% assign away_team = competition.competitors | where: 'homeAway', 'away' | first %}
        {% assign home_team = competition.competitors | where: 'homeAway', 'home' | first %}
        
        <div class="game-row">
          <div class="teams">
            {% if status.type.completed and away_team.score and home_team.score %}
              {{ away_team.team.displayName }} {{ away_team.score }} - {{ home_team.score }} {{ home_team.team.displayName }}
            {% else %}
              {{ event.name }}
            {% endif %}
            <span class="status">({{ status.type.shortDetail }})</span>
          </div>
          <div class="meta">
            {{ event.date | date: "%a %b %d, %I:%M %p" }} · {{ competition.venue.fullName }}
          </div>
        </div>
      {% endfor %}
    {% else %}
      <div class="game-row">
        <div class="teams">No games scheduled</div>
      </div>
    {% endif %}
  </div>
</div>

<style>
  .plugin {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    padding: 16px;
    color: #000;
    background: #fff;
    height: 100vh;
    overflow: hidden;
  }
  
  .title {
    font-size: 18px;
    font-weight: bold;
    margin: 0 0 12px 0;
    border-bottom: 2px solid #000;
    padding-bottom: 4px;
  }
  
  .games {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  
  .game-row {
    padding: 8px 0;
    border-bottom: 1px solid #ccc;
  }
  
  .game-row:last-child {
    border-bottom: none;
  }
  
  .teams {
    font-weight: bold;
    font-size: 14px;
    margin-bottom: 2px;
  }
  
  .status {
    font-weight: normal;
    color: #666;
  }
  
  .meta {
    font-size: 11px;
    color: #666;
  }
</style>
